$def with(ratings_count, ratings_average, page_type)

$if ratings_average:
  $ star_class = 'readers-stats__star' if page_type == 'book_page' else 'readers-stats__star--byline'
  $ half_star_class = 'readers-stats__star--half' if page_type == 'book_page' else 'readers-stats__star--byline-half'
  $ has_half_star = 1 > (float(ratings_average) - int(ratings_average)) >= 0.5
    $:('<span class="{}">★</span>'.format(star_class) * int(ratings_average))
    $if has_half_star:
      $:('<span class="{}">★</span>'.format(half_star_class))
    <span itemprop="ratingValue">
      $ rounded_avg = "%.1f" % ratings_average
      $ fmt_ratings_count = "{:,}".format(ratings_count)
      $ ratings_label = _('rating') if ratings_count == 1 else _('ratings')
      $:_('%(ratings_avg)s (%(ratings_count)s %(ratings_label)s)', ratings_avg=rounded_avg, ratings_count=fmt_ratings_count, ratings_label=ratings_label)
    </span>
